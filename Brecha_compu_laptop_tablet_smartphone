
* ACC TIC SEGUN GENERO
*-------------------------------



cd "C:\Users\jleiva\Desktop\Jose\Bases"

cd "C:\Users\JOSE\Desktop\BD_ERESTEL\Bases"


cd "C:\Users\jleiva\Desktop\Jose\Bases"

*-------------


*------------------------------------------------------------------
* 1. En el acceso a equipos TIC según género: Cambiar la tasa de acceso a Smartphone para que este en términos de personas.
*------------------------------------------------------------------


// 2012 - 2013

foreach x in  12 13  {
	
	use OSIPTEL_personas20`x'.dta,clear

	gener PersonaConSmart=0 if (q13==4 | q13==5)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if q13==1 | q13==2 | q13==3 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if q12==2 //Personas (a partir de 12 aÃ±os) que no tienen celular


	di "*** Año 20`x' ***"

	di "Con factor de expansion"
	tab  q4 PersonaConSmart  [iw=fact_exp], nofreq row 

	di "Test de medias"

	ttest PersonaConSmart , by(q4)

	di "Sin factor de expansion"

	tab  q4 PersonaConSmart , nofreq row 

}
	
	
	
// 2014	

	use OSIPTEL_personas2014.dta,clear

	gener PersonaConSmart=0 if (q12==2 | q12==3)  
	
	//Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if q12==1
	
	//Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if q11==2
	//Personas (a partir de 12 aÃ±os) que no tienen celular


	di "*** Año 2014 ***"

	di "Con factor de expansion"
	tab  q4 PersonaConSmart  [iw=fact_exp], nofreq row 

	
	di "Test de medias"

	ttest PersonaConSmart , by(q4)

	di "Sin factor de expansion"

	tab  q4 PersonaConSmart , nofreq row 
	
		
	




// 2015 -2021 

foreach x in 15 16 18 19 21 { 
		
	use OSIPTEL_personas20`x'.dta,clear

	drop PersonaConSmart
	gener PersonaConSmart=0 if (v2==2 | v2==3)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if v2==1 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if v1==2 //Personas (a partir de 12 aÃ±os) que no tienen celular


	di "*** Año 20`x' ***"

	di "Con factor de expansion"
	tab  q4 PersonaConSmart  [iw=fact_exp], nofreq row 

	
	di "Test de medias"

	ttest PersonaConSmart , by(q4)

	di "Sin factor de expansion"

	tab  q4 PersonaConSmart , nofreq row 
*/
		
}


*------------------------------------------------------------------
* 2_ Desagregación según género de cada equipo TIC (computadora, laptop, Tablet y smartphone) según variables socioeconómicas (nivel educativo, grupo etario, nivel socioeconómico, lengua materna, condición de discapacidad, ámbito geográfico, regiones). 

*Si el número de observaciones es pequeño para su desagregación según variables socioeconómicas para los casos de computadora, Tablet o laptop, entonces agruparlo en uno solo. Smartphone es en términos de personas acá también.
*------------------------------------------------------------------


* Hacemos la base a nivel de jefe de hogares
*============================================


foreach x in 12 13 14 15 16 18 19 21 {

di "AÑO 20`x' *****************"

use OSIPTEL_personas20`x'.dta , clear
destring ficha , replace
sort ficha 
drop if q3!=1
save "jefe_hog20`x'" , replace

use "OSIPTEL_hogares20`x'.dta" , clear
destring ficha , replace
sort ficha 
merge ficha using "jefe_hog20`x'"
drop if _merge!=3
save OSIPTEL_unido20`x'.dta ,replace
erase jefe_hog20`x'.dta
}




*====================
** Arreglamos la base
*=====================

// 2012 - 2013

foreach x in 12 13  {
	
	
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	clonevar computadora=p133 
	clonevar tablet=p134 
	clonevar laptop=p135 
	clonevar cq9=q9 
	
	save Base_lamina20`x'.dta, replace

	
}


// 2014 - 2016

foreach x in 14 15 16 {
	
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	clonevar computadora=p133 
	clonevar tablet=p136 
	clonevar laptop=p134 
	clonevar cq9=q9_1 
	
	save Base_lamina20`x'.dta, replace

}



// 2018 - 2019

foreach x in 18 19 {
	
	use Base_lamina20`x'.dta, clear
	
	clonevar computadora=p13_2_02 
	clonevar tablet=p13_2_05 
	clonevar laptop=p13_2_03 
	clonevar cq9=q9_1 
	
	save Base_lamina20`x'.dta, replace

}


// 2021 

foreach x in 21 {
	
	use Base_lamina20`x'.dta, clear
	
	clonevar computadora=p13_3_1 
	clonevar tablet=p13_6_1 
	clonevar laptop=p13_4_1 
	clonevar cq9=q9_1 
	
	save Base_lamina20`x'.dta, replace

}




* Computadora, Laptop y Tablet:
*---------------------------------


*====================
** Segun estudios
*=====================

	

// 2012 - 2021


foreach y in computadora laptop tablet {
	
	foreach x in /*12 13 14 15 16 18 19 */21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')
	
	recode cq9 (1/4=1 "A lo más primaria") (5/6=5 "Secundaria") (7/11 = 7 "Superior") , g(estudios)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios r`y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios r`y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios r`y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios r`y' if q4==2, nofreq row
	
	
	di "Test de medias"
	di "========================"
	
	
	di "A lo mas primaria"
	
	ttest r`y' if estudios==1 , by(q4)
	
	di "Secundaria"
	
	ttest r`y' if estudios==5 , by(q4)
	
	di "Superior"
	
	ttest r`y' if estudios==7 , by(q4)
	
	
}

	
	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	gen dispo=0 if computadora!=0
	replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios dispo [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios dispo  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios dispo  if q4==2, nofreq row
	
	di "Test de medias"
	di "========================"
	
	
	di "A lo mas primaria"
	
	ttest dispo if estudios==1 , by(q4)
	
	di "Secundaria"
	
	ttest dispo if estudios==5 , by(q4)
	
	di "Superior"
	
	ttest dispo if estudios==7 , by(q4)

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}




*====================
* Grupo etario
*====================


// 2012 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*12 13 14 15 16 18 19 */21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	recode q5 (0/14=0) (15/29=1 "Jovenes") (30/59=2 "Adultos") (60/max=3 "A. Mayores") , g(redad)
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')
	
	
	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' if q4==2, nofreq row
	
	
	di "Test de medias"
	di "========================"
	
	di "Jovenes"
	
	ttest r`y' if redad==1 , by(q4)
	
	di "Adultos"
	
	ttest r`y' if redad==2 , by(q4)
	
	di "Adultos mayores"
	
	ttest r`y' if redad==3 , by(q4)
	
	
	
}
	
	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	 gen dispo=0 if computadora!=0
	 replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con factor de expansion"
	di "========================="
	
	di "Hombre"
	di "==================="
	
	tab redad dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad dispo [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================="
	
	di "Hombre"
	di "==================="
	
	tab redad dispo if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad dispo if q4==2, nofreq row
	
	di "Test de medias"
	di "========================"
	
	di "Jovenes"
	
	ttest dispo if redad==1 , by(q4)
	
	di "Secundaria"
	
	ttest dispo if redad==2 , by(q4)
	
	di "Superior"
	
	ttest dispo if redad==3 , by(q4)
	
	
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}


*===========================
* Nivel socioeconómico
*===========================


// 2013 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	recode nse (1/3=1 "ABC") (4/5=3 "DE"), gen(rnse)
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')


	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y'  if q4==2, nofreq row
	
	
	di "Test de medias"
	di "============="
	
	
	di "ABC"
	ttest r`y' if rnse==1 , by(q4)
	
	di "DE"
	ttest r`y' if rnse==3 , by(q4)
	
	
	
}
	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	 gen dispo=0 if computadora!=0
	 replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con factor de expansion"
	di "======================="
	
	
	di "Hombre"
	di "==================="
	
	tab rnse dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse dispo [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "======================="

	di "Hombre"
	di "==================="
	
	tab rnse dispo  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse dispo  if q4==2, nofreq row
	
	
	di "Test de medias"
	di "=============="
	
	di "ABC"
	ttest dispo if rnse==1 , by(q4)
	
	di "DE"
	ttest dispo if rnse==3 , by(q4)
	
	
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}




*=================
* Lengua materna
*=================

// 2012 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	recode q6 (1=1 "Castellano") (2=2 "Quechua") (3=3 "Aymara") (4/max=4 "Otro") , g(rq6)
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')

	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "=================="
	
	di "Castellano"
	
	ttest r`y' if rq6==1 , by(q4)
	
	di "Quechua"
	
	ttest r`y' if rq6==2 , by(q4)
	
	di "Aymara"
	
	ttest r`y' if rq6==3 , by(q4)
	
	di "Otro"
	
	ttest r`y' if rq6==4 , by(q4)
	
	
	
	
}
	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	gen dispo=0 if computadora!=0
	replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con fact_exp"
	di "==============="
	
	di "Hombre"
	di "==================="
	
	tab rq6 dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 dispo [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin fact_exp"
	di "==============="
	
	di "Hombre"
	di "==================="
	
	tab rq6 dispo if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 dispo if q4==2, nofreq row
	
	di "Test de medias"
	di "=================="
	
	di "Castellano"
	
	ttest dispo if rq6==1 , by(q4)
	
	di "Quechua"
	
	ttest dispo if rq6==2 , by(q4)
	
	di "Aymara"
	
	ttest dispo if rq6==3 , by(q4)
	
	di "Otro"
	
	ttest dispo if rq6==4 , by(q4)

	
	
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}



*=========================
* Condición de discapacidad
*=========================


// 2019 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*19 */ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	
	gen discap =0 if q11_1!=.
	replace discap=1 if q11_1==1 | q11_2==1 | q11_3==1 | q11_4==1 | q11_5==1 | q11_6==1
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')

	
	di "Con factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "SIN DISCPACIDAD"
	
	ttest r`y' if discap==0 , by(q4)
	
	di "CON DISCAPACIDAD"
	
	ttest r`y' if discap==1 , by(q4)
	
	
	
	
}
	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	 gen dispo=0 if computadora!=0
	 replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab discap dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap dispo [iw=fact_exp] if q4==2, nofreq row

	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab discap dispo if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap dispo  if q4==2, nofreq row

	di "Test de medias"
	di "======================"
	
	di "SIN DISCPACIDAD"
	
	ttest dispo if discap==0 , by(q4)
	
	di "CON DISCAPACIDAD"
	
	ttest dispo if discap==1 , by(q4)
	

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}




*==================
* Ámbito geográfico
*=================


// 2012 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*12 13 14 15 16 18 19 */ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear

	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')

	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Lima Metropolitana"
	
	ttest r`y' if ambito==1 , by(q4)
	
	di "Resto Urbano"
	
	ttest r`y' if ambito==2 , by(q4)
	
	di "Rural"
	
	ttest r`y' if ambito==3 , by(q4)
	
	
}

	*-----------------------
	
	di "****************"
	di "LOS 3 SERVICIOS"
	
	
	 gen dispo=0 if computadora!=0
	 replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
		
	tab ambito dispo [iw=fact_exp] if q4==2, nofreq row
		
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito dispo if q4==1, nofreq row
	
	di "Mujer" 
	di "================="

	tab ambito dispo if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Lima Metropolitana"
	
	ttest dispo if ambito==1 , by(q4)
	
	di "Resto Urbano"
	
	ttest dispo if ambito==2 , by(q4)
	
	di "Rural"
	
	ttest dispo if ambito==3 , by(q4)
	

	
	
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}



*=================
* Regiones
*=================

// 2012 - 2021

foreach y in computadora laptop tablet {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear
	recode `y' (1=1 "Si") (2=0 "No") (3=0) , g(r`y')

	di "Con facto de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Test de medias"
	
	foreach z of numlist 1/6 8/14 16/25 27 {

	di "Region `z'"
	
	di "Hombre"
	tab depart `y' if q4==1 & depart==`z', nofreq row
	
	di "Mujer" 
	tab depart `y' if q4==2 & depart==`z', nofreq row
		
	ttest r`y' if depart==`z' , by(q4)
	
	}
	
}

}


* "LOS 3 SERVICIOS"

	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	di ""
	di "Año 20`x' **********"
	
	use Base_lamina20`x'.dta, clear

	gen dispo=0 if computadora!=0
	replace dispo=1 if computadora==1 | laptop==1 | tablet==1
	
	di "Con fact_exp"
	
	di "Hombre"
	di "==================="
	
	tab depart dispo [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart dispo [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	
	di "Hombre"
	di "==================="
	
	tab depart dispo if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart dispo if q4==2, nofreq row
		
	
	di "Test de medias"
	
	foreach z of numlist 1/6 8/14 16/25 27 {

	di "Region `z'"
	
	di "Hombre"
	tab depart dispo if q4==1 & depart==`z', nofreq row
	
	di "Mujer" 
	tab depart dispo if q4==2 & depart==`z', nofreq row
		
	ttest dispo if depart==`z' , by(q4)
	
	}
	
}



******************** SMARTPHONE


// 2012 - 2013

foreach x in  12 13  {
	
	use OSIPTEL_personas20`x'.dta,clear

	drop PersonaConSmart
	
	gener PersonaConSmart=0 if (q13==4 | q13==5)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if q13==1 | q13==2 | q13==3 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if q12==2 //Personas (a partir de 12 aÃ±os) que no tienen celular


	clonevar cq9 = q9
	
	save OSIPTEL_personas20`x'.dta, replace
	
}
	
	
	
// 2014	

	use OSIPTEL_personas2014.dta,clear

	drop PersonaConSmart
	gener PersonaConSmart=0 if (q12==2 | q12==3)  
	
	//Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if q12==1
	
	//Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if q11==2
	//Personas (a partir de 12 aÃ±os) que no tienen celular

	clonevar cq9 = q9_1
	save OSIPTEL_personas2014.dta, replace
	




// 2015 -2021 

foreach x in 15 16 18 19 21 { 
		
	use OSIPTEL_personas20`x'.dta,clear

	*drop PersonaConSmart
	gener PersonaConSmart=0 if (v2==2 | v2==3)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if v2==1 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if v1==2 //Personas (a partir de 12 aÃ±os) que no tienen celular

	clonevar cq9 = q9_1

	save OSIPTEL_personas20`x'.dta, replace
		
}





*====================
** Segun estudios
*=====================



// 2012 - 2021


foreach y in PersonaConSmart {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear
		drop PersonaConSmart
	gener PersonaConSmart=0 if (v2==2 | v2==3)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if v2==1 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if v1==2 //Personas (a partir de 12 aÃ±os) que no tienen celular

	
	recode q9 (1/4=1 "A lo más primaria") (5/6=5 "Secundaria") (7/11 = 7 "Superior") , g(estudios)
	
	
	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios `y' [iw=fact_exp] if q4==1 & q5>11 , nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios `y' [iw=fact_exp] if q4==2 & q5>11, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios `y' if q4==1 & q5>11, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios `y' if q4==2 & q5>11, nofreq row
	
	
	di "Test de medias"
	di "========================"
	
	
	di "A lo mas primaria"
	
	ttest `y' if estudios==1 & q5>11 , by(q4)
	
	di "Secundaria"
	
	ttest `y' if estudios==5 & q5>11 , by(q4)
	
	di "Superior"
	
	ttest `y' if estudios==7 & q5>11, by(q4)
	
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}


*====================
* Grupo etario
*====================


// 2012 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear
	drop PersonaConSmart
	gener PersonaConSmart=0 if (v2==2 | v2==3)  //Personas (a partir de 12 aÃ±os) que tienen celular pero que no es smartphone (o no saben)

	replace PersonaConSmart=1 if v2==1 //Personas (a partir de 12 aÃ±os) que tienen un celular smartphone    

	replace PersonaConSmart=0 if v1==2 //Personas (a partir de 12 aÃ±os) que no tienen celular

	
	recode q5 (0/14=0) (15/29=1 "Jovenes") (30/59=2 "Adultos") (60/max=3 "A. Mayores") , g(redad)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' if q4==2, nofreq row
	
	
	di "Test de medias"
	di "========================"
	
	di "Jovenes"
	
	ttest `y' if redad==1 , by(q4)
	
	di "Secundaria"
	
	ttest `y' if redad==2 , by(q4)
	
	di "Superior"
	
	ttest `y' if redad==3 , by(q4)
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}


*===========================
* Nivel socioeconómico
*===========================


// 2013 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear
	
	recode nse (1/3=1 "ABC") (4/5=3 "DE"), gen(rnse)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y'  if q4==2, nofreq row
	
	
	di "Test de medias"
	di "============="
	
	
	di "ABC"
	ttest `y' if rnse==1 , by(q4)
	
	di "DE"
	ttest `y' if rnse==3 , by(q4)
	
	
	
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}





*=================
* lengua materna
*=================

// 2012 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear
	
	recode q6 (1=1 "Castellano") (2=2 "Quechua") (3=3 "Aymara") (4/max=4 "Otro") , g(rq6)
	
	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "=================="
	
	di "Castellano"
	
	ttest `y' if rq6==1 , by(q4)
	
	di "Quechua"
	
	ttest `y' if rq6==2 , by(q4)
	
	di "Aymara"
	
	ttest `y' if rq6==3 , by(q4)

	di "Otro"
	
	ttest `y' if rq6==4 , by(q4)
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}


*=========================
* Condición de discapacidad
*=========================


// 2019 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear
	
	gen discap =0 if q11_1!=.
	replace discap=1 if q11_1==1 | q11_2==1 | q11_3==1 | q11_4==1 | q11_5==1 | q11_6==1

	di "Con factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "SIN DISCPACIDAD"
	
	ttest `y' if discap==0 , by(q4)
	
	di "CON DISCAPACIDAD"
	
	ttest `y' if discap==1 , by(q4)
	
	
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}




*==================
* Ámbito geográfico
*=================


// 2012 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear

	gener ambito=1 if (dep_est==151 | dep_est==26)  //Lima Metropolitana
	replace ambito=2 if area==1 & (dep_est!=151 & dep_est!=26)  //Resto Urbano
	replace ambito=3 if area==2  //Ámbito Rural
	label variable ambito "Ámbito Geográfico"
	label define ambito 1 "Lima Metropolitana" 2 "Resto Urbano" 3 "Ámbito Rural"  
	label values ambito ambito

	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Lima Metropolitana"
	
	ttest `y' if ambito==1 , by(q4)
	
	di "Resto Urbano"
	
	ttest `y' if ambito==2 , by(q4)
	
	di "Rural"
	
	ttest `y' if ambito==3 , by(q4)
	
		
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}



*=================
* Regiones
*=================

// 2012 - 2021

foreach y in PersonaConSmart {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Equipo: `y' ********"
	di ""
	di "Año 20`x' **********"
	
	use OSIPTEL_personas20`x'.dta,clear

	clonevar depart = depa
	replace depart=27 if depart==7 | depart==15
	
	di "Con facto de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"

	foreach z of numlist 1/6 8/14 16/25 27 {

	di "Region `z'"
	
	di "Hombre"
	tab depart `y' if q4==1 & depart==`z', nofreq row
	
	di "Mujer" 
	tab depart `y' if q4==2 & depart==`z', nofreq row
		
	ttest `y' if depart==`z' , by(q4)
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

} 

	}











* -------------------------------------------------------------
* Gráficos según género del acceso a internet en términos de personas y su distribución según variables socioeconómicas. Para ello tienes que hacer merge de la base de hogares con la base de personas. Por ejm si el ID de la base de hogares un jefe hogar dijo que tenía internet fijo colocar a todas las personas de ese ID de hogar que cuentan con internet fijo.
*---------------------------------------------------------------


** Creando la base

foreach x in  12 13 14 15 16 18 19 21 {

di "AÑO 20`x' *****************"

use OSIPTEL_hogares20`x'.dta , clear
destring ficha , replace
sort ficha 
save OSIPTEL_hogares20`x'.dta , replace

use OSIPTEL_personas20`x'.dta , clear
destring ficha , replace
drop cod_per
sort ficha 
merge ficha using "OSIPTEL_hogares20`x'.dta"
*drop if _merge!=3
save total_nivpers20`x'.dta ,replace

}




** Homogenizando

foreach x in  12 13  {

di "AÑO 20`x' *****************"

use total_nivpers20`x'.dta ,clear
fre q9

clonevar cq9=q9
save total_nivpers20`x'.dta ,replace

}


foreach x in  14 15 16   {

di "AÑO 20`x' *****************"

use total_nivpers20`x'.dta ,clear
fre q9_1

clonevar cq9=q9_1
save total_nivpers20`x'.dta ,replace

}


foreach x in  18 19 21  {

di "AÑO 20`x' *****************"

use total_nivpers20`x'.dta ,clear
fre q9

clonevar cq9=q9
save total_nivpers20`x'.dta ,replace

}


*===================================================
***** Acc internet segun variables socioeconómicas
*===================================================

*====================
** Segun estudios
*=====================



// 2012 - 2021


foreach y in inter int_f int_m /*solo_intf solo_intm */{
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	
	recode cq9 (1/4=1 "A lo más primaria") (5/6=5 "Secundaria") (7/11 = 7 "Superior") , g(estudios)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab estudios `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab estudios `y' if q4==2, nofreq row
	
	
	di "Test de medias"
	di "========================"
		
	di "A lo mas primaria"
	
	ttest `y' if estudios==1 , by(q4)
	
	di "Secundaria"
	
	ttest `y' if estudios==5 , by(q4)
	
	di "Superior"
	
	ttest `y' if estudios==7 , by(q4)
	
	
	
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}


*====================
* Grupo etario
*====================


// 2012 - 2021


foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	
	recode q5 (0/14=0) (15/29=1 "Jovenes") (30/59=2 "Adultos") (60/max=3 "A. Mayores") , g(redad)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab redad `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab redad `y' if q4==2, nofreq row
	
	
	di "Test de medias"
	di "========================"
	
	di "Jovenes"
	
	ttest `y' if redad==1 , by(q4)
	
	di "Secundaria"
	
	ttest `y' if redad==2 , by(q4)
	
	di "Superior"
	
	ttest `y' if redad==3 , by(q4)
	
}

}


*===========================
* Nivel socioeconómico
*===========================


// 2013 - 2021

foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in  /*13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	
	recode nse (1/3=1 "ABC") (4/5=3 "DE"), gen(rnse)

	di "Con factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "========================"
	
	di "Hombre"
	di "==================="
	
	tab rnse `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rnse `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Test de medias"
	di "============="
	
	di "ABC"
	ttest `y' if rnse==1 , by(q4)
	
	di "DE"
	ttest `y' if rnse==3 , by(q4)
	
	
	
}

di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="
di "==================="

}





*=================
* lengua materna
*=================

// 2012 - 2021

foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	
	recode q6 (1=1 "Castellano") (2=2 "Quechua") (3=3 "Aymara") (4/max=4 "Otro") , g(rq6)
	

	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y' [iw=fact_exp] if q4==2, nofreq row
	
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab rq6 `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab rq6 `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "=================="
	
	di "Castellano"
	
	ttest `y' if rq6==1 , by(q4)
	
	di "Quechua"
	
	ttest `y' if rq6==2 , by(q4)
	
	di "Aymara"
	
	ttest `y' if rq6==3 , by(q4)
	
	di "Otro"
	
	ttest `y' if rq6==4 , by(q4)
	
	
	
}

}


*=========================
* Condición de discapacidad
*=========================


// 2019 - 2021

foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in /*19 */ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	
	gen discap =0 if q11_1!=.
	replace discap=1 if q11_1==1 | q11_2==1 | q11_3==1 | q11_4==1 | q11_5==1 | q11_6==1


	di "Con factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================"
	
	di "Hombre"
	di "==================="
	
	tab discap `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab discap `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "SIN DISCPACIDAD"
	
	ttest `y' if discap==0 , by(q4)
	
	di "CON DISCAPACIDAD"
	
	ttest `y' if discap==1 , by(q4)
	
}

}




*==================
* Ámbito geográfico
*=================


// 2012 - 2021

foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	gener ambito=1 if (dep_est==151 | dep_est==26)  //Lima Metropolitana
	replace ambito=2 if area==1 & (dep_est!=151 & dep_est!=26)  //Resto Urbano
	replace ambito=3 if area==2  //Ámbito Rural
	label variable ambito "Ámbito Geográfico"
	label define ambito 1 "Lima Metropolitana" 2 "Resto Urbano" 3 "Ámbito Rural" 
	label values ambito ambito

	*-----------------------
	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	di "Con factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "======================="
	
	di "Hombre"
	di "==================="
	
	tab ambito `y'  if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab ambito `y'  if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Lima Metropolitana"
	
	ttest `y' if ambito==1 , by(q4)
	
	di "Resto Urbano"
	
	ttest `y' if ambito==2 , by(q4)
	
	di "Rural"
	
	ttest `y' if ambito==3 , by(q4)
	
		
}

}



*=================
* Regiones
*=================

// 2012 - 2021

foreach y in inter int_f int_m /*solo_intf solo_intm */ {
	
	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	clonevar depart = depa
	replace depart=27 if depart==7 | depart==15

	
	* Internet
	gen inter=0 if t1!=.
	replace inter=1 if t1==1 | t1==2 | t1==3
	
	* Int fijo
	gen int_f=0 if t1!=.
	replace int_f=1 if t1==1 | t1==3
	
	* Int movil
	gen int_m=0 if t1!=.
	replace int_m=1 if t1==2 | t1==3
	
	* Solo int fija

	gen solo_intf=0 if t1!=.
	replace solo_intf=1 if t1==1
	
	* Solo int movil
	gen solo_intm=0 if t1!=.
	replace solo_intm=1 if t1==2
	
	*-------------------------
	di "Con facto de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' [iw=fact_exp] if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' [iw=fact_exp] if q4==2, nofreq row
	
	di "Sin factor de expansion"
	di "==================="
	
	di "Hombre"
	di "==================="
	
	tab depart `y' if q4==1, nofreq row
	
	di "Mujer" 
	di "================="
	
	tab depart `y' if q4==2, nofreq row
	
	di "Test de medias"
	di "======================"
	
	di "Test de medias"
	
	foreach z of numlist 1/6 8/14 16/25 27 {

	di "Region `z'"
	
	di "Hombre"
	tab depart `y' if q4==1 & depart==`z', nofreq row
	
	di "Mujer" 
	tab depart `y' if q4==2 & depart==`z', nofreq row
		
	ttest `y' if depart==`z' , by(q4)
	
}
}
}
















*---------------------------------------------------------------
* Realizar gráficos según género de las razones por las cuales no tienen acceso a internet, no usan internet, no tienen acceso a telefonía móvil.
*---------------------------------------------------------------


*** No tienen acc a internet


* INT MOVIL
*============

	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	di "JH SOLO CON INTERNET FIJO , NO INTERNET MOVIL"
	
	di "Perú"
	tab o1 [iw= fact_exp] if o1==2
	tab o7 [iw= fact_exp] if o1==2 
	
	
	di "Hombre"
	di "========================"
	tab o1 [iw= fact_exp] if o1==2 & q4==1 
	tab o7 [iw= fact_exp] if o1==2 & q4==1 
	
	di "Mujer"
	di "==========================="
	tab o1 [iw= fact_exp] if o1==2  & q4==2
	tab o7 [iw= fact_exp] if o1==2  & q4==2 


	di "*------------------------------------"
	
	di "SIN CONEXION FIJA NI CONEXION MOVIL"
	
	di "Perú"
	tab o17a [iw= fact_exp] if o17a==2 
	tab o19 [iw= fact_exp] if o17a==2
	
	tab o19_otros [iw= fact_exp] if o17a==2

	
	di "Hombre"
	di "========================"
	tab o17a [iw= fact_exp] if o17a==2 & q4==1 
	tab o19 [iw= fact_exp] if o17a==2 & q4==1 
	
	tab o19_otros [iw= fact_exp] if o17a==2 & q4==1 

	
	di "Mujer"
	di "==========================="
	tab o17a [iw= fact_exp] if o17a==2  & q4==2
	tab o19 [iw= fact_exp] if o17a==2  & q4==2 
	
	tab o19_otros [iw= fact_exp] if o17a==2  & q4==2 


	}



	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

* INT FIJO
*=================

// Base 2021

	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	di "JH SOLO CON INTERNET MOVIL , NO INTERNET FIJO"
	
	di "Perú"
	tab o8b [iw= fact_exp] if o8b==2
	tab o13 [iw= fact_exp] if o8b==2 
	
	
	di "Hombre"
	di "========================"
	tab o8b [iw= fact_exp] if o8b==2 & q4==1 
	tab o13 [iw= fact_exp] if o8b==2 & q4==1 

	di "Mujer"
	di "==========================="
	tab o8b [iw= fact_exp] if o8b==2  & q4==2
	tab o13 [iw= fact_exp] if o8b==2  & q4==2 


	di "*------------------------------------"
	
	di "SIN CONEXION FIJA NI CONEXION MOVIL"
	
	di "Perú"
	tab o14a [iw= fact_exp] if o14a==2 
	tab o16 [iw= fact_exp] if o14a==2
	
	tab o16_otros [iw= fact_exp] if o14a==2
	
	
	di "Hombre"
	di "========================"
	tab o14a [iw= fact_exp] if o14a==2 & q4==1 
	tab o16 [iw= fact_exp] if o14a==2 & q4==1 

	tab o16_otros [iw= fact_exp] if o14a==2 & q4==1 
	
	di "Mujer"
	di "==========================="
	tab o14a [iw= fact_exp] if o14a==2  & q4==2
	tab o16 [iw= fact_exp] if o14a==2  & q4==2 

	tab o16_otros [iw= fact_exp] if o14a==2  & q4==2 


	}


	
*** No usan internet

	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------

	di "Hombre"
	di "==================="
	
	tab u9 [iw=fact_exp] if q4==1
	
	di "Mujer" 
	di "================="
	
	tab u9 [iw=fact_exp] if q4==2
	

	di "PERÚ"
	di "==================="
	
	tab u9 [iw=fact_exp]

	
	}




*** No tienen acc a tlf movil


	foreach x in /*12 13 14 15 16 18 19*/ 21 {
	
	di "Tipo de conexion : `y' ********"
	di ""
	di "Año 20`x' **********"
	di ""
	use total_nivpers20`x'.dta ,clear
	
	*---------------
	
	di "JEFE DE HOGAR CON TLF FIJO PERO SIN TLF MOVIL"
	
	di "Perú"
	tab s1 [iw= fact_exp] if s1==2
	tab s6 [iw= fact_exp] if s1==2 
	
	
	di "Hombre"
	di "========================"
	tab s1 [iw= fact_exp] if s1==2 & q4==1 
	tab s6 [iw= fact_exp] if s1==2 & q4==1 

	di "Mujer"
	di "==========================="
	tab s1 [iw= fact_exp] if s1==2  & q4==2
	tab s6 [iw= fact_exp] if s1==2  & q4==2 


	di "*------------------------------------"
	
	di "JEFE DE HOGAR SIN TLF FIJO Y SIN TLF MOVIL"
	
	di "Perú"
	tab s19 [iw= fact_exp] if s19==2 
	tab s22 [iw= fact_exp] if s19==2
	
	di "Hombre"
	di "========================"
	tab s19 [iw= fact_exp] if s19==2 & q4==1 
	tab s22 [iw= fact_exp] if s19==2 & q4==1 

	di "Mujer"
	di "==========================="
	tab s19 [iw= fact_exp] if s19==2  & q4==2
	tab s22 [iw= fact_exp] if s19==2  & q4==2 


	}



	format o7 %30.0f
	
* Test de medias	
	
	di "TLF MOVIL ************"
	

	gen prefiero_fijo=0 if s6!=. | s22!=.
	replace prefiero_fijo=1 if s6==4 | s22==4
	
	gen no_interesa=0 if s6!=. | s22!=.
	replace no_interesa=1 if s6==5 | s22==5

	gen no_necesita=0 if s6!=. | s22!=.
	replace no_necesita=1 if s6==6 | s22==6
	
	gen complicado=0 if s6!=. | s22!=.
	replace complicado=1 if s6==1 | s22==1	
	
	gen no_senal=0 if s6!=. | s22!=.
	replace no_senal=1 if s6==7 | s22==7	
	
	gen caro_cel=0 if s6!=. | s22!=.
	replace caro_cel=1 if s6==3 | s22==3
		
	*------------- OTROS (AQUI ME QUEDEEEEEEEEEEEEEE)
	
	gen caro_llam =0 if s6!=. | s22!=.
	replace caro_llam=1 if s6==2 | s22==2
	
	tab q4 caro_llam [iw= fact_exp ], nofreq row



	




